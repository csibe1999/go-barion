Barion API: Request the current state of a payment

GET /v4/payment/<PaymentId>/paymentstate

The /payment/paymentstate API endpoint is used to query the details and current state of a given payment.

v4 This API endpoint is available in API v4 only.

NOTEThis is the preferred API endpoint for querying the state of a payment.

Authentication
Use header-based shop authentication when using the endpoint.

Header variables
| Property name | Property type | Limitations and constraints | Description |
|:-------------:|:-------------:|:---------------------------:|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
| x-pos-key | Guid | Required | The secret API key of the shop, generated by Barion. Used to authenticate the shop in the Barion API, but does not provide access to the account itself that owns the shop. |

Path variables:
| Property name | Property type | Limitations and constraints | Description |
|:-------------:|:-------------:|:---------------------------:|:---------------------------------------------------:|
| PaymentId | Guid | Required | The identifier of the payment in the Barion system. |

Example: GET https://api.barion.com/v4/payment/f28b2b2572644d1084bbb3a7d8362337/paymentstate

Output properties:
| Property name | Property type | Description | |
|:---------------------:|:----------------------------:|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|:-:|
| PaymentId | Guid | The identifier of the payment in the Barion system. | |
| PaymentRequestId | string | The identifier of the payment in the shop's system. | |
| POSId | Guid | The public identifier of the shop that created the payment. | |
| POSName | string | The name of the shop that created the payment. | |
| POSOwnerEmail | string | The e-mail address of the owner of the shop that created the payment. | |
| POSOwnerCountry | string | ISO2 country code of the owner of the shop that created the payment. | |
| Status | PaymentStatus | The current status of the payment in the Barion system. | |
| PaymentType | string | The type of the payment. Can be Immediate, Reservation, or DelayedCapture. | |
| AllowedFundingSources | string[] | The allowed funding sources that were defined when creating the payment. | |
| FundingSource | string | The funding source that was used to complete the payment. Can be Balance, BankCard or BankTransfer. If the payment is not yet completed, this is empty. | |
| FundingInformation | FundingInformation | Detailed information about the funding source that was used to complete the payment. If no payment attempt was made, this is empty. | |
| RecurrenceType | RecurrenceType | The RecurrenceType that was defined in the payment/start request for the recurring scenario. | |
| TraceId | string | The Trace Id that identifies that recurring scenario. Read more about this here | |
| GuestCheckout | bool | Indicates whether the payment allows guest checkout. | |
| CreatedAt | DateTime | The locale-specific payment creation timestamp. | |
| CompletedAt | DateTime | The locale-specific payment completion timestamp. If the payment is not yet completed, this is empty. | |
| ValidUntil | DateTime | The payment must be completed before this locale-specific payment expiration timestamp. | |
| ReservedUntil | DateTime | If the payment is a reservation, the shop's owner has until this locale-specific expiration timestamp to finish it. If the payment isn't a reservation, this is empty. | |
| DelayedCaptureUntil | DateTime | If the payment is a delayed capture, the shop owner has until this locale-specific expiration timestamp to capture it. If the payment isn't a delayed capture, this is empty. | |
| Transactions | DetailedPaymentTransaction[] | An array containing a detailed structure of all transactions associated with the payment. | |
| Total | decimal | The total amount of the payment at the time of the request to the endpoint. If a reservation was finished with a lower amount, or if the transaction is a refund of a previously completed payment, this can be lower than at payment creation time. | |
| Currency | string | The payment's 3-character ISO 4217 currency code. | |
| SuggestedLocale | string | Indicates the language that the Barion Smart Gateway should be displayed to the payer. | |
| FraudRiskScore | int | A risk score computed by the anti-fraud analysis, ranging from 0 (completely legit) to 100 (certain fraud). Transactions below a fraud risk score of 10 are usually safe. Transactions between 10 and 30 are risky, caution is advised. Transactions with a fraud risk score of 30 or above are blocked automatically to avoid fraud. | |
| CallbackUrl | string | The URL (including the payment identifier) where the Barion system will send (or has already sent) a request to whenever there is a change in the state of the payment. | |
| RedirectUrl | string | The URL (including the payment identifier) where the payer gets (or has already got) redirected to after the payment is, or was completed, or cancelled. | |
| PaymentMethod | PaymentMethod | The last method used when attempting to complete the payment. If there was no payment attempt made yet, this property is Unknown.
